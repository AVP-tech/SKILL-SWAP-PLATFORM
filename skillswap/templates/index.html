{% extends "base.html" %}

{% block content %}
<section class="hero">
  <div class="panel hero-copy">
    <div class="eyebrow">Peer-to-peer learning</div>
    <h1>Exchange real skills with real people.</h1>
    <p class="lead">
      Offer what you know, discover what others can teach, and build practical connections through direct swaps.
      No marketplace friction, just learning loops.
    </p>

    <div class="hero-actions">
      {% if current_user.is_authenticated %}
      <a class="btn btn-primary" href="{{ url_for('browse_page') }}">Find a Match</a>
      <a class="btn btn-outline" href="{{ url_for('profile_page') }}">Update Profile</a>
      {% else %}
      <a class="btn btn-primary" href="{{ url_for('register_page') }}">Create Account</a>
      <a class="btn btn-outline" href="{{ url_for('login_page') }}">Sign In</a>
      {% endif %}
    </div>

    <p class="footer-note">Tip: keep your offered and wanted skills specific to get better matches.</p>
  </div>

  <div class="panel metrics">
    <div class="metric-card">
      <span class="value">Skill-first</span>
      <span class="label">Search public profiles by offered skills and send swap requests instantly.</span>
    </div>
    <div class="metric-card">
      <span class="value">Profile controls</span>
      <span class="label">Set location, availability, and public/private visibility from one place.</span>
    </div>
    <div class="metric-card">
      <span class="value">Request workflow</span>
      <span class="label">Track sent and received requests with clear pending/accepted/rejected status.</span>
    </div>
  </div>
</section>

<section class="section">
  <div class="section-head">
    <h2>How It Works</h2>
    <span class="pill">3 quick steps</span>
  </div>

  <div class="grid grid-3">
    <article class="card">
      <h3>1. Build Your Profile</h3>
      <p class="muted">Add your name, location, availability, and the skill you can offer plus what you want to learn.</p>
    </article>
    <article class="card">
      <h3>2. Browse Public Skills</h3>
      <p class="muted">Search public users by skill and find people whose expertise matches your learning goals.</p>
    </article>
    <article class="card">
      <h3>3. Swap and Respond</h3>
      <p class="muted">Send requests and manage responses from one requests page with status tracking.</p>
    </article>
  </div>
</section>

{% if current_user.is_authenticated %}
<section class="section">
  <div class="section-head">
    <h2>Recommended For You</h2>
    <span class="pill">Based on your profile</span>
  </div>

  <div class="grid grid-2">
    {% if recommended_matches %}
      {% for item in recommended_matches %}
      <article class="card">
        <h3>{{ item.name }}</h3>
        <p class="muted">{{ item.location or "Location not shared" }}{% if item.availability %} â€¢ {{ item.availability }}{% endif %}</p>
        <div class="kv" style="margin-top:8px;">
          <span><strong>Offers:</strong> {{ item.skill }}</span>
          <span><strong>Match Score:</strong> {{ item.score }}</span>
        </div>
        <div style="display:flex; gap:8px; margin-top:10px; flex-wrap:wrap;">
          <a class="btn btn-soft btn-sm" href="{{ url_for('browse_page') }}">Browse & Request</a>
        </div>
      </article>
      {% endfor %}
    {% else %}
      <article class="card" style="grid-column:1 / -1;">
        <h3>Build your profile to unlock better recommendations</h3>
        <p class="muted">Add both offered and wanted skills, location, and availability to get smarter matches.</p>
        <div style="margin-top:10px;">
          <a class="btn btn-primary btn-sm" href="{{ url_for('profile_page') }}">Complete Profile</a>
        </div>
      </article>
    {% endif %}
  </div>
</section>

<section class="section">
  <div class="grid grid-3">
    <article class="card">
      <h3>Trending Skills</h3>
      {% if trending_skills %}
      <div class="stack" style="margin-top:8px;">
        {% for trend in trending_skills %}
        <div style="display:flex;justify-content:space-between;gap:10px;">
          <span>{{ trend.skill }}</span>
          <span class="pill">{{ trend.count }}</span>
        </div>
        {% endfor %}
      </div>
      {% else %}
      <p class="muted">No trends available yet.</p>
      {% endif %}
    </article>

    <article class="card">
      <h3>Your Engagement Snapshot</h3>
      {% if engagement_snapshot %}
      <div class="stack" style="margin-top:8px;">
        <div><strong>{{ engagement_snapshot.friends_count }}</strong> friend connections</div>
        <div><strong>{{ engagement_snapshot.pending_received }}</strong> pending requests to review</div>
        <div><strong>{{ engagement_snapshot.open_tickets }}</strong> open support queries</div>
      </div>
      {% else %}
      <p class="muted">Login to see your personalized activity.</p>
      {% endif %}
    </article>

    <article class="card">
      <h3>Stay Engaged</h3>
      <p class="muted">Reply faster, accept good matches, and keep conversations active to grow your learning network.</p>
      <div class="stack" style="margin-top:10px;">
        <a class="btn btn-soft btn-sm" href="{{ url_for('friends_page') }}">Open Friends</a>
        <a class="btn btn-outline btn-sm" href="{{ url_for('support_page') }}">Submit a Query</a>
      </div>
    </article>
  </div>
</section>
{% else %}
<section class="section">
  <div class="grid grid-3">
    <article class="card">
      <h3>Trending Skills</h3>
      {% if trending_skills %}
      <div class="stack" style="margin-top:8px;">
        {% for trend in trending_skills %}
        <div style="display:flex;justify-content:space-between;gap:10px;">
          <span>{{ trend.skill }}</span>
          <span class="pill">{{ trend.count }}</span>
        </div>
        {% endfor %}
      </div>
      {% else %}
      <p class="muted">Join the platform to explore emerging skill trends.</p>
      {% endif %}
    </article>
    <article class="card">
      <h3>Guided Suggestions</h3>
      <p class="muted">Profile and search fields support smart suggestions for locations and skills, helping you fill forms faster.</p>
    </article>
    <article class="card">
      <h3>Built for Collaboration</h3>
      <p class="muted">Swap requests, friends, chat, and query support make this feel like a real learning community.</p>
    </article>
  </div>
</section>
{% endif %}
{% endblock %}
